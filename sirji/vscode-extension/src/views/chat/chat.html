<!DOCTYPE html>
<html lang="en">

<head>
  <title>Sirji Chat</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Use a meta tag to enforce Content Security Policy -->
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'none'; style-src-elem  'nonce-${nonce}'; script-src 'nonce-${nonce}';" />
  <link nonce="${nonce}" rel="stylesheet" type="text/css" href="${chatStyleUri}" />
</head>

<body>
  <main>

    <div class="fixedHeader">
      <div class="progressContainer" id="progressCircle">
        <svg id="progressRing" width="30" height="30">
          <circle id="outerBorder" stroke="#f1f1f1" stroke-width="1" fill="transparent" r="9" cx="15" cy="15"></circle>
          <circle id="progressRingCircle" stroke="#ADD8E6" stroke-width="2" fill="transparent" r="8" cx="15" cy="15">
          </circle>
          <circle id="innerBorder" stroke="#f1f1f1" stroke-width="1" fill="transparent" r="6" cx="15" cy="15"></circle>
        </svg>
        <div id="progressText">0 of 0</div>
      </div>
      <div id="openSettings" class="icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 256 256"><path d="M128 80a48 48 0 1 0 48 48 48.05 48.05 0 0 0-48-48m0 80a32 32 0 1 1 32-32 32 32 0 0 1-32 32m88-29.84q.06-2.16 0-4.32l14.92-18.64a8 8 0 0 0 1.48-7.06 107.2 107.2 0 0 0-10.88-26.25 8 8 0 0 0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186 40.54a8 8 0 0 0-3.94-6 107.7 107.7 0 0 0-26.25-10.87 8 8 0 0 0-7.06 1.49L130.16 40h-4.32L107.2 25.11a8 8 0 0 0-7.06-1.48 107.6 107.6 0 0 0-26.25 10.88 8 8 0 0 0-3.93 6l-2.64 23.76q-1.56 1.49-3 3L40.54 70a8 8 0 0 0-6 3.94 107.7 107.7 0 0 0-10.87 26.25 8 8 0 0 0 1.49 7.06L40 125.84v4.32L25.11 148.8a8 8 0 0 0-1.48 7.06 107.2 107.2 0 0 0 10.88 26.25 8 8 0 0 0 6 3.93l23.72 2.64q1.49 1.56 3 3L70 215.46a8 8 0 0 0 3.94 6 107.7 107.7 0 0 0 26.25 10.87 8 8 0 0 0 7.06-1.49L125.84 216q2.16.06 4.32 0l18.64 14.92a8 8 0 0 0 7.06 1.48 107.2 107.2 0 0 0 26.25-10.88 8 8 0 0 0 3.93-6l2.64-23.72q1.56-1.48 3-3l23.78-2.8a8 8 0 0 0 6-3.94 107.7 107.7 0 0 0 10.87-26.25 8 8 0 0 0-1.49-7.06Zm-16.1-6.5a74 74 0 0 1 0 8.68 8 8 0 0 0 1.74 5.48l14.19 17.73a91.6 91.6 0 0 1-6.23 15l-22.6 2.56a8 8 0 0 0-5.1 2.64 74 74 0 0 1-6.14 6.14 8 8 0 0 0-2.64 5.1l-2.51 22.58a91.3 91.3 0 0 1-15 6.23l-17.74-14.19a8 8 0 0 0-5-1.75h-.48a74 74 0 0 1-8.68 0 8 8 0 0 0-5.48 1.74l-17.78 14.2a91.6 91.6 0 0 1-15-6.23L82.89 187a8 8 0 0 0-2.64-5.1 74 74 0 0 1-6.14-6.14 8 8 0 0 0-5.1-2.64l-22.58-2.52a91.3 91.3 0 0 1-6.23-15l14.19-17.74a8 8 0 0 0 1.74-5.48 74 74 0 0 1 0-8.68 8 8 0 0 0-1.74-5.48L40.2 100.45a91.6 91.6 0 0 1 6.23-15L69 82.89a8 8 0 0 0 5.1-2.64 74 74 0 0 1 6.14-6.14A8 8 0 0 0 82.89 69l2.51-22.57a91.3 91.3 0 0 1 15-6.23l17.74 14.19a8 8 0 0 0 5.48 1.74 74 74 0 0 1 8.68 0 8 8 0 0 0 5.48-1.74l17.77-14.19a91.6 91.6 0 0 1 15 6.23L173.11 69a8 8 0 0 0 2.64 5.1 74 74 0 0 1 6.14 6.14 8 8 0 0 0 5.1 2.64l22.58 2.51a91.3 91.3 0 0 1 6.23 15l-14.19 17.74a8 8 0 0 0-1.74 5.53Z"/></svg>
      </div>
    </div>

    <div id="chatContainer">
      <div id="messageContainer"></div>
      <div id="inputContainer">
        <textarea id="userInput" placeholder="Type a message..."></textarea>
        <button id="sendBtn">Send</button>
      </div>
    </div>

    <div id="plannerModal" class="modal">
      <div class="modal-content">
        <span id="closePlanner">&times;</span>
        <h2>Planner</h2>
        <ul id="plannerStepsList"></ul>
      </div>
    </div>

    <div id="settingsModal" class="modal">
      <div class="modal-content">
        <span id="closeSettings">&times;</span>
        <h2>Environment Variables Configuration</h2>
        <div class="input-wrapper">
          <label for="SIRJI_OPENAI_API_KEY">OpenAI API Key</label>
          <input type="text" id="SIRJI_OPENAI_API_KEY" placeholder="Enter the OpenAI api key" />
          <span class="error-message" id="SIRJI_OPENAI_API_KEY_ERROR"></span>
        </div>
        <div class="input-wrapper">
          <span class="error-message" id="save_settings_error"></span>
        </div>
        <button id="saveSettings">Save</button>
      </div>
    </div>
  </main>
  <script type="module" nonce="${nonce}" src="${chatScriptUri}"></script>
</body>

</html>